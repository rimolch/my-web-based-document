import{Q as A,T as B,r as x,o as d,f,b as t,d as b,a as r,F as C,c as V,w,u as v,n as I,k as q,l as P,h as $,m as T,p as Z,q as E,g as H,i as M,t as F,O as K}from"./app-0jD_U881.js";import{s as j,a as L,e as Q,O as G,A as R}from"./AuthenticatedLayout-_E8msa5o.js";import{h as J,_ as W}from"./http-helper-7HKkKYeF.js";import{_ as O}from"./Checkbox-16AlpGuJ.js";import{_ as X}from"./ConfirmationDialog-D88GlSFa.js";import{_ as Y}from"./DownloadFilesButton-Uf9sCTBc.js";import{_ as ee,a as te}from"./SecondaryButton-DOSrhAGb.js";import{_ as le,a as se,b as ae}from"./TextInput-owTTohJd.js";import{P as oe}from"./PrimaryButton--FYT-SEj.js";import"./ApplicationLogo-kOi6OoIv.js";import"./_plugin-vue_export-helper-x3n3nnut.js";import"./DangerButton-NVg_iRUd.js";const ne=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-4 h-4 mr-2"},[t("path",{"fill-rule":"evenodd",d:"M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z","clip-rule":"evenodd"})],-1),re={__name:"DeleteFilesButton",props:{deleteAll:{type:Boolean,required:!1,default:!1},deleteIds:{type:Array,required:!1}},emits:["delete"],setup(c,{emit:o}){const e=A(),i=B({all:null,ids:[],parent_id:null}),n=x(!1),s=c,u=o;function y(){if(!s.deleteAll&&!s.deleteIds.length){j("Please select at least one file to delete");return}n.value=!0}function p(){n.value=!1}function g(){var h,_;(h=e.props.folder)!=null&&h.id&&(i.parent_id=(_=e.props.folder)==null?void 0:_.id),s.deleteAll?i.all=!0:i.ids=s.deleteIds,i.delete(route("file.delete"),{onSuccess:()=>{n.value=!1,u("delete"),L("Selected files have been deleted.")}}),console.log("Delete",s.deleteAll,s.deleteIds)}return(h,_)=>(d(),f(C,null,[t("button",{onClick:y,class:"inline-flex items-center px-2 py-2 text-sm font-medium text-gray-900"},[ne,b(" Delete ")]),r(X,{show:n.value,message:"Are you sure you want to delete selected files?",onCancel:p,onConfirm:g},null,8,["show"])],64))}},ie={class:"p-6"},de=t("h2",{class:"text-lg font-medium text-gray-900"}," Share Files ",-1),ce={class:"mt-6"},ue={class:"mt-6 flex justify-end"},me={__name:"ShareFilesModal",props:{modelValue:Boolean,allSelected:Boolean,selectedIds:Array},emits:["update:modelValue"],setup(c,{emit:o}){const e=B({email:null,all:!1,ids:[],parent_id:null}),i=A(),n=x(null),s=c,u=o;function y(){P(()=>n.value.focus())}function p(){e.parent_id=i.props.folder.id,console.log(s.selectedIds,s.allSelected),s.allSelected?(e.all=!0,e.ids=[]):e.ids=s.selectedIds;const h=e.email;e.post(route("file.share"),{preserveScroll:!0,onSuccess:()=>{g(),e.reset(),L(`Selected files will be shared to "${h}" if the emails exists in the system`)},onError:()=>n.value.focus()})}function g(){u("update:modelValue"),e.clearErrors(),e.reset()}return(h,_)=>(d(),V(te,{show:s.modelValue,onShow:y,"max-width":"sm"},{default:w(()=>[t("div",ie,[de,t("div",ce,[r(le,{for:"shareEmail",value:"Enter Email Address",class:"sr-only"}),r(se,{type:"text",ref_key:"emailInput",ref:n,id:"shareEmail",modelValue:v(e).email,"onUpdate:modelValue":_[0]||(_[0]=S=>v(e).email=S),class:I([v(e).errors.email?"border-red-500 focus:border-red-500 focus:ring-red-500":"","mt-1 block w-full"]),placeholder:"Enter Email Address",onKeyup:q(p,["enter"])},null,8,["modelValue","class"]),r(ae,{message:v(e).errors.email,class:"mt-2"},null,8,["message"])]),t("div",ue,[r(ee,{onClick:g},{default:w(()=>[b("cancel")]),_:1}),r(oe,{class:I(["ml-3",{"opacity-25":v(e).processing}]),onClick:p,disable:v(e).processing},{default:w(()=>[b(" Send ")]),_:1},8,["class","disable"])])])]),_:1},8,["show"]))}},fe=t("path",{"fill-rule":"evenodd",d:"M15.75 4.5a3 3 0 11.825 2.066l-8.421 4.679a3.002 3.002 0 010 1.51l8.421 4.679a3 3 0 11-.729 1.31l-8.421-4.678a3 3 0 110-4.132l8.421-4.679a3 3 0 01-.096-.755z","clip-rule":"evenodd"},null,-1),pe=[fe],he={__name:"ShareFilesButton",props:{allSelected:{type:Boolean,required:!1,default:!1},selectedIds:{type:Array,required:!1}},emits:["restore"],setup(c,{emit:o}){A(),B({all:null,ids:[],parent_id:null});const e=x(!1),i=c;function n(){if(!i.allSelected&&!i.selectedIds.length){j("Please select at least one file to share");return}e.value=!0}return(s,u)=>(d(),f(C,null,[t("button",{onClick:n,class:"inline-flex items-center px-2 py-2 text-sm font-medium text-gray-900"},[(d(),f("svg",{onClick:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-4 h-4 mr-2"},pe)),b(" Share ")]),r(me,{modelValue:e.value,"onUpdate:modelValue":u[0]||(u[0]=y=>e.value=y),"all-selected":c.allSelected,"selected-ids":c.selectedIds},null,8,["modelValue","all-selected","selected-ids"])],64))}},_e={class:"flex items-center justify-between p-1 mb-3"},ve={class:"inline-flex items-center space-x-1 md:space-x-3"},xe=t("svg",{"aria-hidden":"true",class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})],-1),ye={key:1,class:"flex items-center"},ge=t("svg",{"aria-hidden":"true",class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1),we={class:"flex-2 overflow-auto"},be={class:"min-w-full"},ke={class:"bg-gray-50 border-gray-500"},Ce={class:"bg-gray-200"},Se={class:"text-sm font-medium text-gray-900 px-6 py-4 text-left w-[30px] mx-w-[30px] pr-0"},$e=t("th",{class:"text-sm font-medium text-gray-1000 px-6 py-4 text-left"},"Name",-1),Fe=t("th",{class:"text-sm font-medium text-gray-1000 px-6 py-4 text-left"},"File",-1),Ve=t("th",{class:"text-sm font-medium text-gray-1000 px-6 py-4 text-left"},"Size",-1),Ie=["onClick","onDblclick"],Ae={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 w-[30px] mx-w-[30px] pr-0"},Be={class:"text-gray-900 px-6 py-5 whitespace-nowrap text-sm font-medium inline-flex items-center justify-center"},De={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ee={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Me={key:0,class:"py-8 text-center text-lg text-gray-700"},Qe={__name:"MyFiles",props:{files:Object,folder:Object,ancestors:Object},setup(c){const o=x(!1),e=x({}),i=x(null),n=c,s=x({data:n.files.data,next:n.files.links.next}),u=x(""),y=$(()=>u.value?s.value.data.filter(l=>l.name.toLowerCase().includes(u.value.toLowerCase())):s.value.data),p=$(()=>Object.entries(e.value).filter(l=>l[1]).map(l=>l[0])),g=$(()=>[...s.value.data].sort((l,m)=>l.name.localeCompare(m.name)));function h(l){l.is_folder&&K.visit(route("myFiles",{folder:l.path}))}function _(){s.value.next!==null&&J(s.value.next).then(l=>{s.value.data=[...s.value.data,...l.data],s.value.next=l.links.next})}function S(){s.value.data.forEach(l=>{e.value[l.id]=o.value})}function N(l){e.value[l.id]=!e.value[l.id],D(l)}function D(l){if(!e.value[l.id])o.value=!1;else{let m=!0;for(let a of s.value.data)if(!e.value[a.id]){m=!1;break}o.value=m}}function z(){o.value=!1,e.value={}}T(()=>{s.value={data:n.files.data,next:n.files.links.next}});const U=new IntersectionObserver(l=>{l.forEach(m=>m.isIntersecting&&_())},{rootMargin:"-250px 0px 0px 0px"});return Z(()=>{Q.on(G,l=>{u.value=l}),U.observe(i.value)}),(l,m)=>(d(),V(R,null,{default:w(()=>[t("nav",_e,[t("ol",ve,[(d(!0),f(C,null,E(c.ancestors.data,a=>(d(),f("li",{key:a.id,class:"inline-flex items-center"},[a.parent_id?(d(),f("div",ye,[ge,r(v(M),{href:l.route("myFiles",{folder:a.path}),class:"ml-1 text-sm font-medium text-gray-800 hover:text-blue-600 md:ml-4 dark:text-gray-600 dark:hover:text-blue"},{default:w(()=>[b(F(a.name),1)]),_:2},1032,["href"])])):(d(),V(v(M),{key:0,href:l.route("myFiles"),class:"inline-flex items-center text-sm font-medium text-gray-600 hover:text-blue-600 dark:text-gray-600 dark:hover:text-blue"},{default:w(()=>[xe,b(" My Files ")]),_:1},8,["href"]))]))),128))]),t("div",null,[r(he,{"all-selected":o.value,"selected-ids":p.value},null,8,["all-selected","selected-ids"]),r(Y,{all:o.value,ids:p.value,class:"mr-2"},null,8,["all","ids"]),r(re,{"delete-all":o.value,"delete-ids":p.value,onDelete:z},null,8,["delete-all","delete-ids"])])]),t("div",we,[t("table",be,[t("thead",ke,[t("tr",Ce,[t("th",Se,[r(O,{onChange:S,checked:o.value,"onUpdate:checked":m[0]||(m[0]=a=>o.value=a)},null,8,["checked"])]),$e,Fe,Ve])]),t("tbody",null,[(d(!0),f(C,null,E(g.value,a=>(d(),f("tr",{key:a.id,onClick:k=>N(a),onDblclick:k=>h(a),class:I(["border-b transition duration-300 ease-in-out hover:bg-green-100 cursor-pointer bg-gray-300",e.value[a.id]||o.value?"bg-blue-100":"bg-gray"])},[t("td",Ae,[r(O,{onChange:k=>D(a),modelValue:e.value[a.id],"onUpdate:modelValue":k=>e.value[a.id]=k,checked:e.value[a.id]||o.value},null,8,["onChange","modelValue","onUpdate:modelValue","checked"])]),t("td",Be,F(a.name),1),t("td",De,[r(W,{file:a},null,8,["file"])]),t("td",Ee,F(a.size),1)],42,Ie))),128))])]),y.value.length?H("",!0):(d(),f("div",Me," There is no file in this folder ")),t("div",{ref_key:"loadMoreIntersect",ref:i},null,512)])]),_:1}))}};export{Qe as default};
